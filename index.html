<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>AI Training</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/styles/index.css" />
  </head>

  <body>
    <div id="page-1">
      <div class="page-container">
        <h1 class="title">MAKE: AI ROBOTS</h1>
        <button id="requestPortButton" class="small-btn">Connect your micro:bit to your AI!</button>
      </div>
    </div>

    <script>
      const connectButton = document.getElementById("requestPortButton");

      connectButton.addEventListener("click", async () => {
        try {
          // 특정 productId를 제거하고, 모든 micro:bit 인터페이스 탐색
          const device = await navigator.usb.requestDevice({
            filters: [{ vendorId: 0x0d28 }]
          });

          await device.open(); // 장치를 엽니다
          if (device.configuration === null) {
            await device.selectConfiguration(1);
          }

          // 가능한 인터페이스 출력
          for (let i = 0; i < device.configuration.interfaces.length; i++) {
            console.log(`Interface ${i}:`, device.configuration.interfaces[i]);
          }

          await device.claimInterface(0); // 시리얼 포트를 위한 인터페이스 번호를 시도
          console.log("Micro:bit connected");

          // 페이지 전환
          document.getElementById("page-1").classList.add("hide");
        } catch (err) {
          console.error("Error connecting to micro:bit: ", err);
          alert(`Failed to connect to micro:bit: ${err.message}`);
        }
      });
    </script>
  </body>
</html>
