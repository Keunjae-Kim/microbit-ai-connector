<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-GV15VYJMQP"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }

      gtag("js", new Date());

      gtag("config", "G-GV15VYJMQP");
    </script>

    <meta charset="utf-8" />
    <title>Ai Training</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="/styles/index.css" />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Karla:ital,wght@0,400;0,700;0,800;1,400&display=swap"
      rel="stylesheet"
    />

    <!-- Jquery Styles -->
    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css"
    />
  </head>

  <body onload="checkCookie()">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-WF39LXQ"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="desktop-only">
      <h2>This Application is best used with a Desktop</h2>
    </div>

    <div id="page-1">
      <div class="page-container">
        <div class="sctn">
          <h1 class="title">MICROBIT WITH AI</h1>
          <p class="paragraph news">
            NEW Oct 27, 2024: We have released a new AI powered chatbot for your AI Robot projects! Use the power of a full large language model to chat with your project and make AI powered decisions. You can access the new tool at <br />
            
            <span class="btn-cont">
              <a
                href="https://makeAIRobots.com/chatbot"
                target="_blank"
              >
                <button class="small-btn">
                  Chatbot Imagination Lab
                </button>
              </a>
            </span>
          </p>
          <br />
          <br />
          <p class="paragraph">
            Give your micro:bit project AI superpowers! This site will allow
            your micro:bit to use your computer's webcam to recognize images.
            You can recognize facial expressions, poses, and any object you can
            think of to put in front of your webcam! What will your micro:bit do
            when it can tell if you're smiling, or if you've deposited the right
            amount of coins?

            <br /><br />Use the links below to get your Teachable Machine image
            recognition model and your micro:bit starter code. Then click on the
            third button to connect everything together!!
          </p>

          <span class="btn-cont">
            <a
              href="https://teachablemachine.withgoogle.com/"
              target="_blank"
              id="GA-GTM-Btn-1"
            >
              <button class="small-btn">
                1. Google Teachable Machine AI Model
              </button>
            </a>
          </span>
          <span class="btn-cont">
            <a
              href="https://makecode.microbit.org/_Mjw1p2JsUUUE"
              target="_blank"
              id="GA-Micro-Btn-1"
            >
              <button class="small-btn">2. Starter micro:bit code</button>
            </a>
          </span>

          <span class="btn-container">
            <button id="requestPortButton">
              <h1>3. Connect your micro:bit to your AI!</h1>
            </button>
            <p class="paragraph btn-sub">
              Select the Microbit in the popup screen. Psst, it might be called
              mbed Serial Port.
            </p>
          </span>
        </div>
        <div class="sctn img-sctn"></div>
        <a href="https://www.makershed.com/products/make-ai-robots-print">
          <img
            src="/assets/images/robot.webp"
            class="microbit-img"
            alt="Microbit.png"
          />
        </a>
      </div>
    </div>

    <div id="page-2" class="hide">
      <div>
        <span class="help-section">
          <h1>Not sure what to do?</h1>
          <p>Visit the Teachable Machine to train an AI project:</p>
          <a
            href="https://teachablemachine.withgoogle.com/"
            target="_blank"
            id="GA-GTM-Btn-2"
          >
            <button
              onclick="fireClickEvent('btn_click', false, 'teachable_machine')"
              class="small-btn"
            >
              Google Teachable Machine
            </button>
          </a>
          <p>
            New to Google Teachable Machine? Follow these guidelines to learn
            more:
            <a
              class="GA-GTM"
              href="https://teachablemachine.withgoogle.com/faq"
              target="_blank"
              id="GA-GTM-Lnk-2"
              onclick="fireClickEvent('btn_click', false, 'teachable_machine')"
            >
              <em><strong>Guide to Teachable Machine</strong></em></a
            >
          </p>
          <span class="instruction-container">
            <h2>
              When you have finished training your model, follow these 4 simple
              steps:
            </h2>
            <div class="instruction">
              <p><strong>1.</strong> Click “Export Model”</p>
              <img
                src="assets/images/TMS_1.png"
                class="tms-img"
                alt="TMS_1.png"
              />
            </div>
            <div class="instruction">
              <p><strong>2.</strong> Click “Upload My Model”</p>
              <img
                src="assets/images/TMS_2.png"
                class="tms-img"
                alt="TMS_2.png"
              />
            </div>
            <div class="instruction">
              <p><strong>3.</strong> Wait a moment</p>
              <img
                src="assets/images/TMS_3.png"
                class="tms-img"
                alt="TMS_3.png"
              />
            </div>
            <div class="instruction">
              <p>
                <strong>4.</strong> Click “Copy” to copy your link and paste it
                in the space above
              </p>
              <img
                src="assets/images/TMS_4.png"
                class="tms-img"
                alt="TMS_4.png"
              />
            </div>
          </span>
        </span>
        <span id="connectPort">
          <p class="sub-title">
            Paste your Google Teachable machine model link here:
          </p>
          <span class="input-container">
            <input
              id="teachableUrl"
              type="url"
              placeholder="https://teachablemachine.withgoogle.com/models/[...]"
              pattern="https://.*"
              required
            />
            <span id="cam-select">
              <p>
                <label for="cam" class="choose-label">Choose Camera:</label>
                <select name="cam" id="cam"></select>
              </p>
            </span>
            <span id="aud-select">
              <p>
                <label for="aud" class="choose-label">Choose Audio:</label>
                <select name="aud" id="aud"></select>
              </p>
            </span>
            <button id="submitUrl">Ready!</button>
          </span>
        </span>
      </div>
    </div>

    <!-- Socket.io -->
    <script
      src="https://cdn.socket.io/3.1.3/socket.io.min.js"
      integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh"
      crossorigin="anonymous"
    ></script>
    <!-- Teachable Machine: tensorflow-->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <!-- Jquery -->
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <!-- Main Scripts -->
    <script src="/index.js" type="text/javascript"></script>
    <script src="/scripts/serialConnection.js" type="text/javascript"></script>
    <script>
      document.getElementById('requestPortButton').addEventListener('click', async () => {
        try {
          // Request a port and open a connection to the micro:bit
          const port = await navigator.serial.requestPort();
          await port.open({ baudRate: 9600 });

          // If successful, notify the user and display the new content
          alert('Micro:bit connected successfully!');
          document.getElementById('page-1').style.display = 'none';
          document.getElementById('page-2').style.display = 'block';

          // Populate the camera and audio dropdowns
          await populateMediaDevices();
        } catch (error) {
          // Handle user cancellation or connection errors
          console.error('There was an error connecting to the micro:bit:', error);
          alert('Failed to connect to the micro:bit. Please try again.');
        }
      });

      async function populateMediaDevices() {
        try {
          const devices = await navigator.mediaDevices.enumerateDevices();
          const videoSelect = document.getElementById('cam');
          const audioSelect = document.getElementById('aud');

          videoSelect.innerHTML = '';
          audioSelect.innerHTML = '';

          devices.forEach((device) => {
            const option = document.createElement('option');
            option.value = device.deviceId;
            option.text = device.label || `Device ${device.kind}`;

            if (device.kind === 'videoinput') {
              videoSelect.appendChild(option);
            } else if (device.kind === 'audioinput') {
              audioSelect.appendChild(option);
            }
          });

          // Notify if no cameras or microphones were found
          if (videoSelect.options.length === 0) {
            const noVideoOption = document.createElement('option');
            noVideoOption.text = 'No video devices found';
            videoSelect.appendChild(noVideoOption);
          }

          if (audioSelect.options.length === 0) {
            const noAudioOption = document.createElement('option');
            noAudioOption.text = 'No audio devices found';
            audioSelect.appendChild(noAudioOption);
          }
        } catch (error) {
          console.error('Error populating media devices:', error);
          alert('Unable to access media devices. Please check permissions.');
        }
      }
    </script>
  </body>
</html>
